<!DOCTYPE html>
<html>
    <title>Localhost Sourcepoint Website</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>

        body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif; text-align: center; padding: 20px 0;}
        body, html {
            height: 100%;
            color: #777;
            line-height: 1.8;
        }

        body.caption {
            color: #FFFFFF;
            background-color: #E4E4E4;
        }

        table.d {
            table-layout: fixed;
            width: 100%;  
        }

        .table-bordered {
            border: 1px solid #ddd !important;
        }

        table caption {
	        padding: .5em 0;
        }

        @media screen and (max-width: 767px) {
            table caption {
                display: none;
            }
        }

        .p {
            text-align: center;
            padding-top: 140px;
            font-size: 14px;
        }

        .container {
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
            padding-left: 10px;
            padding-right: 10px;
        }

        /* Create a Parallax Effect */
        .bgimg-1, .bgimg-2, .bgimg-3 {
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }

        /* First image (Logo. Full height) */
        .bgimg-1 {
            background-image: url('https://scontent-ber1-1.xx.fbcdn.net/v/t1.6435-9/70835850_1664680460334736_4366743281917231104_n.jpg?_nc_cat=104&ccb=1-5&_nc_sid=e3f864&_nc_ohc=pV8hyY-mTU4AX9CU7ns&_nc_ht=scontent-ber1-1.xx&oh=00_AT8CHPhTJNr2V_2HyHeadJFXQdJ06MicWKxVzz4pCCsBKg&oe=622E8FEE');
            min-height: 100%;
        }

        /* Second image (Portfolio) */
        .bgimg-2 {
            background-image: url("https://www.w3schools.com/w3images/parallax2.jpg");
            min-height: 400px;
        }

        /* Third image (Contact) */
        .bgimg-3 {
            background-image: url("https://www.w3schools.com/w3images/parallax3.jpg");
            min-height: 400px;
        }

        select {
            text-align-last:center;
        }

        .w3-wide {letter-spacing: 10px;}
        .w3-hover-opacity {cursor: pointer;}


.tooltip {
  position: relative;
  display: inline-block;
  border-bottom: 1px dotted black;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 120px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 5px 0;
  position: absolute;
  z-index: 1;
  bottom: 125%;
  left: 50%;
  margin-left: -60px;
  opacity: 0;
  transition: opacity 0.3s;
}

.tooltip .tooltiptext::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}

    </style>

    <body>

        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
        
        <script>
            !function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){var r=n(2);t.exports=!r((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){n(4),function(){if("function"!=typeof window.__tcfapi){var t,e=[],n=window,r=n.document;!n.__tcfapi&&function t(){var e=!!n.frames.__tcfapiLocator;if(!e)if(r.body){var o=r.createElement("iframe");o.style.cssText="display:none",o.name="__tcfapiLocator",r.body.appendChild(o)}else setTimeout(t,5);return!e}()&&(n.__tcfapi=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];if(!r.length)return e;if("setGdprApplies"===r[0])r.length>3&&2===parseInt(r[1],10)&&"boolean"==typeof r[3]&&(t=r[3],"function"==typeof r[2]&&r[2]("set",!0));else if("ping"===r[0]){var i={gdprApplies:t,cmpLoaded:!1,apiVersion:"2.0"};"function"==typeof r[2]&&r[2](i,!0)}else e.push(r)},n.addEventListener("message",(function(t){var e="string"==typeof t.data,r={};try{r=e?JSON.parse(t.data):t.data}catch(t){}var o=r.__tcfapiCall;o&&n.__tcfapi(o.command,o.parameter,o.version,(function(n,r){var i={__tcfapiReturn:{returnValue:n,success:r,callId:o.callId}};e&&(i=JSON.stringify(i)),t.source.postMessage(i,"*")}))}),!1))}}()},function(t,e,n){var r=n(0),o=n(5).f,i=Function.prototype,c=i.toString,u=/^s*function ([^ (]*)/;r&&!("name"in i)&&o(i,"name",{configurable:!0,get:function(){try{return c.call(this).match(u)[1]}catch(t){return""}}})},function(t,e,n){var r=n(0),o=n(6),i=n(10),c=n(11),u=Object.defineProperty;e.f=r?u:function(t,e,n){if(i(t),e=c(e,!0),i(n),o)try{return u(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(0),o=n(2),i=n(7);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(8),o=n(1),i=r.document,c=o(i)&&o(i.createElement);t.exports=function(t){return c?i.createElement(t):{}}},function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(9))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(1);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){var r=n(1);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}}]);
        </script>

        <script>

            var vendors_vpm = [];
            var vpm_obj = [];
            var cvc_obj = [];
            var tc_pr_obj = [];
            var url_accountid = 1732;
            var url_propertyhref = 'https://dineshjnarayan.github.io/';
            var url_pmid = 547186;
            var url_baseendpoint = 'https://cdn.privacy-mgmt.com';

            function standard_two_cell_row(label, value, style = null, cell_append=false)    {
                //Some outputs from api calls will be displayed as rows with two cells each. One cell for the description, the second for the value
                //When flag cell_append is true the value is a DOM object to be appended to the cell
                //Called by show_getcustomvendorconsents -> cvc_grants -> show_cvc_grants, show_getcustomvendorconsents -> table_consentedpurposes, show_getcustomvendorconsents -> create_selectoption
                //Called by show_vendorpurposemapping -> vpm_mapping, show_vendorpurposemapping -> create_selectoption, parse_errorobject
                var tr = document.createElement('tr');
                if(style) tr.style = style;
                var td = tr.insertCell(0);
                td.style = "width: 50%;";
                if(cell_append) td.appendChild(value); else td.innerHTML = value;
                var td = tr.insertCell(0);
                td.style = "width: 50%;";
                td.innerHTML = label;
                return(tr);
            }

            function table_consentedpurposes(consentedpurposes)  {
                //TCF CustomVendorConsents. Display all consented purposes
                //Called by show_getcustomvendorconsents
                if(consentedpurposes.length < 1)    { return('no data'); }
                var table = document.createElement('table');
                table.style = "width: 100%;";
                var i = 0;
                consentedpurposes.map(purpose => {
                    var style = null;
                    if(i++ % 2 == 0) style = "background-color:#E4E4E4;";
                    var tr = standard_two_cell_row(purpose._id, purpose.name, style);
                    table.appendChild(tr);
                });
                return(table.outerHTML);
            }

            function table_consentedvendors(consentedvendors)  {
                //TCF CustomVendorConsents. Display all consented custom vendors
                //Called by show_getcustomvendorconsents
                if(consentedvendors.length < 1)    { return('no data'); }
                var table = document.createElement('table');
                table.style = "width: 100%;";
                consentedvendors.map(vendor => {
                    var tr = table.insertRow(0)
                    var td = tr.insertCell(0);
                    td.style = "width: 33%;"; 
                    td.innerHTML = vendor.vendorType;
                    var td = tr.insertCell(0);
                    td.style = "width: 33%;";
                    td.innerHTML = vendor.name;
                    var td = tr.insertCell(0);
                    td.style = "width: 33%;";
                    td.innerHTML = vendor._id;
                });
                return(table.outerHTML);
            }

            function show_cvc_grants(vendor_indx)    {
                //TCF CustomVendorConsents. For a selected vendor, update the consent attributed to their purposes and vendor grant
                //Called by show_getcustomvendorconsents -> cvc_grants
                var vendorgrants = Object.values(cvc_obj.grants);
                var vendor_data = vendorgrants[vendor_indx];
                var table = document.getElementById("vendor_grant_list");
                while (table.rows.length > 1) {
                    table.deleteRow(1);
                }
                var style = "background-color:#37383D; color: #FFFFFF; font-weight: bold;";
                var tr = standard_two_cell_row("vendorGrant", vendor_data.vendorGrant, style);
                table.appendChild(tr);
                var purposes = Object.keys(vendor_data.purposeGrants);
                var consents = Object.values(vendor_data.purposeGrants);
                for(i in purposes)   {
                    var style = null;
                    if(i % 2 != 0) style = "background-color:#E4E4E4;";
                    var tr = standard_two_cell_row(purposes[i], consents[i], style);
                    table.appendChild(tr);
                }
                return(table.outerHTML);
            }

            function cvc_grants(grants)  {
                //TCF CustomVendorConsents. For any selected vendor, show the consent attributed to their purposes and vendor grant
                //Called by show_getcustomvendorconsents. The IAB TCF lists consented purposes as consentedPurposes in this API response
                var vendors_cvc = Object.keys(grants);
                var table = document.createElement('table');
                table.style = "width: 100%;";
                table.id = "vendor_grant_list";
                var row = create_selectoption("Select a vendor id:", vendors_cvc, "show_cvc_grants(Object.keys(cvc_obj.grants).indexOf(this.value))");
                table.appendChild(row);
                return(table.outerHTML);
            }

            function show_vpm(vendor_indx)   {
                //TCF VendorPurposeMapping. For a selected vendor, update their attributed purposes and legal basis
                //Called by show_vendorpurposemapping -> vpm_mapping
                var vendor = vpm_obj[vendor_indx];
                const category_types = ["CONSENT", "LEGITIMATE_INTEREST", "NOT_ALLOWED", "DISCLOSURE_ONLY"];
                category_types.map(type => {
                    document.getElementById(type).innerHTML = '';
                });
                vendor.categories.map(category => {
                    var purpose_id = document.createElement('li');
                    purpose_id.innerHTML = category._id;
                    document.getElementById(category.type).appendChild(purpose_id);
                });
            }

            function create_selectoption(label, vendor_id_list, onchange_set)  {
                //TCF VendorPurposeMapping & CustomVendorConsent. Generate select-option box with list of vendor ids
                //Called by show_vendorpurposemapping -> vpm_mapping, show_getcustomvendorconsents -> cvc_grants, showtcdata -> parse_publisherrestrictions
                var select_vendor = document.createElement('select');
                select_vendor.id = "vendor_ids";
                select_vendor.style = "width: 100%;";
                select_vendor.setAttribute("onchange", onchange_set);
                vendor_id_list.map(vendor_id => {
                    var option_vendor_id = document.createElement('option');
                    option_vendor_id.title = "tooltip";
                    option_vendor_id.innerHTML = vendor_id;
                    select_vendor.appendChild(option_vendor_id);
                });
                style = "background-color:#37383D; color: #FFFFFF; font-weight: bold; width: 100%;";
                var tr = standard_two_cell_row(label, select_vendor, style, true);
                return(tr);
            }

            function vpm_mapping(vpm_obj)    {
                //TCF VendorPurposeMapping. For any selected vendor, show the legal basis attributed to their purposes
                //Called by show_vendorpurposemapping. The IAB TCF lists vendor legal basis as categories types in this API response
                //Purposes are listed as categories
                vpm_obj.map(vendor => {
                    vendors_vpm.push(vendor.vendorId);
                });
                if(vendors_vpm.length < 1) return('no data');
                var table = document.createElement('table');
                table.style = "width: 100%;";
                var row = create_selectoption("Select a vendor id:", vendors_vpm, "show_vpm(vendors_vpm.indexOf(this.value))");
                table.appendChild(row);
                var span_data = document.getElementById("vendors_counter");
                span_data.innerHTML = vendors_vpm.length;
                const list_categories_types = ["CONSENT", "LEGITIMATE_INTEREST", "NOT_ALLOWED", "DISCLOSURE_ONLY"];
                list_categories_types.map(type => {
                    var category_type = document.createElement('ol');
                    category_type.id = type;
                    var row = standard_two_cell_row(type, category_type, null, true);
                    table.appendChild(row);
                });
                return(table.outerHTML);
            }

            function list_consented(tcdata_obj)  {
                //TCF getTCData. Create a simple list from TCF data objects for publisher consents & legitimate interests, purpose_consents & legitimate interests, vendor consents & legitimate interests
                //To avoid a very large list being shown only ids of purposes, vendors, publishers that have consent = true are listed
                //Called by show_tcdata
                var list_consented = [];
                var id_list = Object.keys(tcdata_obj);
                var consented = Object.values(tcdata_obj);
                if(consented.length < 1) return 'no data';
                for(indx in consented) {
                    if(consented[indx] == true) {
                        list_consented.push(id_list[indx]);
                    }
                }
                return(list_consented.join(", "));
            }

            function show_publisher_restrictions(purpose_id)    {
                var restrictions = Object.values(tc_pr_obj);
                var restriction = restrictions[purpose_id];
                var vendor_ids = Object.keys(restriction);
                var legal_basis_id = Object.values(restriction);
                var list_vendors = [];
                list_vendors.push([]);
                list_vendors.push([]);
                list_vendors.push([]);
                for(i in legal_basis_id)   {
                    list_vendors[legal_basis_id[i]].push(vendor_ids[i]);
                }
                var table = document.getElementById("purpose_list_pr");
                while (table.rows.length > 1) {
                    table.deleteRow(1);
                }
                var row = standard_two_cell_row("NOT_ALLOWED (0)", list_vendors[0].join(", "));
                table.appendChild(row);
                var row = standard_two_cell_row("CONSENT (1)", list_vendors[1].join(", "), "background-color:#E4E4E4;");
                table.appendChild(row);
                var row = standard_two_cell_row("LEGITIMATE_INTEREST (2)", list_vendors[2].join(", "));
                table.appendChild(row);
                return(table.outerHTML);
            }

            function parse_publisherrestrictions(tc_pr_obj)  {
                var purpose_list = Object.keys(tc_pr_obj);
                if(purpose_list.length < 1)    return('no data');
                var table = document.createElement('table');
                table.style = "width: 100%;";
                table.id = "purpose_list_pr";
                var row = create_selectoption("Select a purpose id:", purpose_list, "show_publisher_restrictions(Object.keys(tc_pr_obj).indexOf(this.value))");
                table.appendChild(row);
                return(table.outerHTML);
            }

            function parse_errorobject(error_obj) {
                //Sourcepoint onError callback. Returns an errorObject which contains the stack trace recorded for this fault
                //This function splits the text into a list, it is easier to follow the events leading to the fault.
                //Called by onError
                var stack_trace = (error_obj.stack).split("\n");
                table = document.createElement('table');
                var tr = standard_two_cell_row("message", error_obj.message); 
                table.appendChild(tr);
                var i = 0;
                stack_trace.map(event => {
                    var style = null;
                    if(i % 2 == 0) style = "background-color:#E4E4E4;";
                    var tr = standard_two_cell_row(stack_trace.length - (i++), event, style);
                    table.appendChild(tr);
                });
                return(table.outerHTML);
            }

            function output_table(table_name, cell_labels, cell_values)   {
                //Results from all API calls are displayed through a table. The functions called before collate and format the data to be published in tables of a set standard
                //cell_labels is the description. cell_values is the information to be shown i.e. text, numbers, a DOM object like a select option box
                //Called by show_ping, show_vendorpurposemapping, show_getcustomvendorconsents, show_tcdata, onMessageReady, onMessageChoiceSelect, onPrivacyManagerAction, onConsentReady, onPMCancel, onMessageReceiveData, onSPPMObjectReady
                var table = document.getElementById(table_name);
                for (let i = 0; i < cell_labels.length; i++) {
                    var row = document.getElementById(table_name).rows.namedItem(cell_labels[i] + '_row');
                    cell_values[i] = (typeof cell_values[i]=='undefined') ? 'no data' : cell_values[i];
                    if(row === null)    {
                        var j = (i*2);
                        var row = table.insertRow(j);
                        var cell_label = row.insertCell(0);
                        cell_label.style = "width: 100%; background-color: #dae4eb;"
                        cell_label.innerHTML = cell_labels[i];
                        var row = table.insertRow(j+1);
                        row.id = cell_labels[i] + '_row';
                        var cell_data = row.insertCell(0);
                        cell_data.style = "width: 100%; align-content: center; background-color: #ECE9E7; word-wrap: break-word;"
                        cell_data.id = cell_labels[i] + '_data';
                    }
                    row.cells.namedItem(cell_labels[i] + '_data').innerHTML = cell_values[i];
                }
            }

        </script>

        <script>

            window._sp_queue = [];

            var url = new URL(window.location.href);
            if(url.searchParams.get("accountid").length > 0)            url_accountid = url.searchParams.get("accountid"); 
            if(url.searchParams.get("propertyhref").length > 0)         url_propertyhref = url.searchParams.get("propertyhref");
            if(url.searchParams.get("pmid").length > 0)                 url_pmid = url.searchParams.get("pmid");   
            if(url.searchParams.get("baseendpoint").length > 0)         url_baseendpoint = url.searchParams.get("baseendpoint");
            window.onload = function() {
                document.getElementById("accountid").value = url_accountid;
                document.getElementById("propertyhref").value = url_propertyhref;
                document.getElementById("pmid").value = url_pmid;
                document.getElementById("baseendpoint").value = url_baseendpoint;
            }
            
            window._sp_ = {
                
                config: {
                    accountId: url_accountid,
                    propertyHref: url_propertyhref,
                    baseEndpoint: url_baseendpoint,
                    gdpr: { },
                    events: {

                        onMessageReady: function (message_type) {
                            const cell_values = [message_type];
                            const cell_labels = ["message_type"];
                            output_table("onmessageready", cell_labels, cell_values);
                            console.log('onMessageReady callback ');
                        },
                        
                        onMessageChoiceSelect: function (message_type, choice_id, choice_type_id) {
                            const cell_values = [message_type, choice_id, choice_type_id];
                            const cell_labels = ["message_type", "choice_id", "choice_type_id"];
                            output_table("onmessagechoiceselect", cell_labels, cell_values);
                            console.log('onMessageChoiceSelect callback');
                        },
                    
                        onPrivacyManagerAction: function (message_type, pmData) {
                            const cell_values = [message_type, pmData.purposeConsent, pmData.vendorConsent];
                            const cell_labels = ["message_type", "purposeConsent", "vendorConsent"];
                            output_table("onprivacymanageraction", cell_labels, cell_values);
                            console.log('onPrivacyManagerAction callback');
                        },
                    
                        onMessageChoiceError: function (message_type, err) {
                            const cell_values = [message_type, JSON.stringify(err)];
                            const cell_labels = ["message_type", "err"];
                            output_table("onmessagechoiceerror", cell_labels, cell_values);
                            console.log('onMessageChoiceError callback');
                        },

                        onConsentReady: function (message_type, consentUUID, euconsent) {
                            const cell_values = [message_type, consentUUID, euconsent];
                            const cell_labels = ["message_type", "consentUUID", "euconsent"];
                            output_table("onconsentready", cell_labels, cell_values);
                            console.log('onConsentReady callback');
                        },
                    
                        onPMCancel: function (message_type) {
                            const cell_values = [message_type];
                            const cell_labels = ["message_type"];
                            output_table("onpmcancel", cell_labels, cell_values);
                            console.log('onPMCancel callback');
                        },
                    
                        onMessageReceiveData: function (message_type, data) {
                            const cell_values = [message_type, data.prtnUUID, data.messageId, data.msgDescription, data.bucket, data.uuid, data.categoryId, data.subCategoryId];
                            const cell_labels = ["message_type", "data:prtnUUID", "data:messageId", "data:msgDescription", "data:bucket", "data:uuid", "data:categoryId", "data:subCategoryId"];
                            output_table("onmessagereceivedata", cell_labels, cell_values);
                            console.log('onMessageReceiveData callback');
                        },
                    
                        onSPPMObjectReady: function () {
                            const cell_values = ["yes"];
                            const cell_labels = ["onsppmobjectready"];
                            output_table("onsppmobject_ready", cell_labels, cell_values);
                            console.log('onSPPMObjectReady callback');
                        },

                        onError: function (message_type, errorCode, errorObject, userReset) {
                            const cell_values = [message_type, errorCode, userReset, parse_errorobject(errorObject)];
                            const cell_labels = ["message_type", "errorCode", "userReset", "errorObject"];
                            output_table("onerror", cell_labels, cell_values);
                            console.log('onError callback');
                        }

                    }
                }
                
            }
        
            function show_ping(pingReturn)    {
                const cell_values = [pingReturn.cmpId, pingReturn.cmpVersion, pingReturn.gdprApplies, pingReturn.tcfPolicyVersion, pingReturn.cmpLoaded, pingReturn.cmpStatus, pingReturn.displayStatus, pingReturn.apiVersion];
                const cell_labels = ["cmpId", "cmpVersion", "gdprApplies", "tcfPolicyVersion", "cmpLoaded", "cmpStatus", "displayStatus", "apiVersion"];
                output_table("callping", cell_labels, cell_values);
            }

            function show_vendorpurposemapping(success, vpm)    {
                vpm_obj = vpm;
                vendors_vpm = [];
                const cell_values = [success, vpm_mapping(vpm_obj)];
                const cell_labels = ["success", "vendor purpose mapping"];
                output_table("getvendorpurposemapping_table", cell_labels, cell_values);
            }

            function show_getcustomvendorconsents(success, cvc)    {
                cvc_obj = cvc;
                const cell_values = [success, cvc.newUser, cvc.dateCreated, table_consentedpurposes(cvc.consentedPurposes), table_consentedvendors(cvc.consentedVendors), cvc_grants(cvc.grants), table_consentedpurposes(cvc.legIntPurposes)];
                const cell_labels = ["success", "newUser", "dateCreated", "consentedPurposes", "consentedVendors", "grants", "legIntPurposes"];
                output_table("getcustomvendorconsents", cell_labels, cell_values);
            }

            function show_tcdata(success, tcdata)   {
                tc_pr_obj = tcdata.publisher.restrictions;
                const cell_values = [   success, tcdata.addtlConsent, tcdata.cmpId, 
                                        tcdata.cmpStatus, tcdata.cmpVersion, tcdata.eventStatus, 
                                        tcdata.gdprApplies, tcdata.isServiceSpecific, tcdata.listenerId, 
                                        tcdata.publisherCC, tcdata.purposeOneTreatment, tcdata.tcString, 
                                        tcdata.tcfPolicyVersion, tcdata.useNonStandardStacks, list_consented(tcdata.publisher.consents), 
                                        JSON.stringify(tcdata.publisher.customPurpose), list_consented(tcdata.publisher.legitimateInterests), parse_publisherrestrictions(tcdata.publisher.restrictions), 
                                        list_consented(tcdata.purpose.consents), list_consented(tcdata.purpose.legitimateInterests), list_consented(tcdata.vendor.consents), 
                                        list_consented(tcdata.vendor.legitimateInterests) ];
                const cell_labels = ["success", "addtlConsent", "cmpId", "cmpStatus", "cmpVersion", "eventStatus", "gdprApplies", "isServiceSpecific", "listenerId", "publisherCC", "purposeOneTreatment", "tcString:", "tcfPolicyVersion", "useNonStandardStacks", "publisher:consents", "publisher:customPurpose", "publisher:legitimateInterests", "publisher:restrictions", "purpose:consents", "purpose:legitimateInterests", "vendor:consents", "vendor:legitimateInterests"];
                output_table("tcfapi_gettcdata", cell_labels, cell_values);
            }

            __tcfapi('addEventListener', 2, function(tcdata, success) {
                // to generate error change tcdata -> tcData >> next documentation
                if(success) {
                    __tcfapi('ping', 2, (pingReturn) => {
                        show_ping(pingReturn);
                        console.log('addEventListener('+tcdata.listenerId+') calling ping');
                    });
                    __tcfapi('getCustomVendorConsents', 2, function(cvc, success) { 
                        show_getcustomvendorconsents(success, cvc);
                        console.log('addEventListener('+tcdata.listenerId+') calling getCustomVendorConsents'); 
                    });
                    if (tcdata.eventStatus === 'useractioncomplete') {
                        show_tcdata(success, tcdata);
                        console.log('addEventListener('+tcdata.listenerId+') calling getTCData and tcdata.eventStatus is useractioncomplete');
                    } else if (tcdata.eventStatus === 'tcloaded') {
                        show_tcdata(success, tcdata);
                        console.log('addEventListener('+tcdata.listenerId+') calling getTCData and tcdata.eventStatus is tcloaded');
                    } else if (tcdata.eventStatus === 'cmpuishown') {
                        console.log('addEventListener('+tcdata.listenerId+') calling and tcdata.eventStatus is cmpuishown');
                    }
                }
            });

            __tcfapi('getVendorPurposeMapping', 2, function(vpm, success) {
                show_vendorpurposemapping(success, vpm);
                console.log("getVendorPurposeMapping called on page load")
            });

            __tcfapi('getTCData', 2, function(tcdata,success)   {
                show_tcdata(success, tcdata);
                console.log("getTCData called on page load");
            });

            //function callback_function_pcc(data, success)  {
            //    console.log("postCustomConsent callback")
            //    console.log("postCustomConsent response: ", data, success)
            //}

            //console.log("postCustomConsent call")
            // --> Add to vendors, working <--
            //__tcfapi('postCustomConsent', 2, callback_function_pcc, ["5f3bc0d7b8e05c606f3dfc27", "5f477cc6c442796aa67839d9", "5fd78083fc186126cb9fabad", "5f3a3e66ee0a81887437291c", "5fda5252b4f7ae27b97a1dfe", "5e7ced57b8e05c47e418b73c"], [], [] );

            // --> Add to purposes, not working <--
            //__tcfapi('postCustomConsent', 2, callback_function_pcc, [], ["6011ea75c5d9c787531b3ecf", "6011ea75c5d9c787531b3f0e"], [] );
            // --> Add to legitimate interests, working <--
            //__tcfapi('postCustomConsent', 2, callback_function_pcc, [], [], ["6011ea75c5d9c787531b3ecf", "6011ea75c5d9c787531b3f0e"] );

            // --> Add to vendors & legitimate interests, working <--
            //__tcfapi('postCustomConsent', 2, callback_function_pcc, ["5f3bc0d7b8e05c606f3dfc27", "5f477cc6c442796aa67839d9", "5fd78083fc186126cb9fabad", "5f3a3e66ee0a81887437291c", "5fda5252b4f7ae27b97a1dfe", "5e7ced57b8e05c47e418b73c"], [], ["6011ea75c5d9c787531b3ecf", "6011ea75c5d9c787531b3f0e"] );

        </script>
        <script src='https://cdn.privacy-mgmt.com/unified/wrapperMessagingWithoutDetection.js' async></script>

        <!-- Navbar (sit on top) -->
        <div class="w3-top">
            <div class="w3-bar" id="myNavbar">
                <a class="w3-bar-item w3-button w3-hover-black w3-hide-medium w3-hide-large w3-right" href="javascript:void(0);" onclick="toggleFunction()" title="Toggle Navigation Menu">
                    <i class="fa fa-bars"></i>
                </a>
                <a href="#home" class="w3-bar-item w3-button">HOME</a>
                <a href="#sp_callbacks" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> SOURCEPOINT CALLBACKS</a>
                <a href="#tcf_apis" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> TCF V2 APIS</a>
                <!--<a href="#gdpr_standard" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> GDPR STANDARD API</a>-->
                <a onclick="window._sp_.gdpr.loadPrivacyManagerModal(url_pmid, 'purposes')" href="javascript:void(0);" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-th"></i> PRIVACY MANAGER</a>
                <a href="#contact" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-envelope"></i> CONTACT</a>
                <a href="#" class="w3-bar-item w3-button w3-hide-small w3-right w3-hover-red">
                    <i class="fa fa-search"></i>
                </a>
            </div>
            <!-- Navbar on small screens -->
            <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium">
                <a href="#sp_callbacks" class="w3-bar-item w3-button" onclick="toggleFunction()">SOURCEPOINT CALLBACKS</a>
                <a href="#tcf_apis" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> TCF V2 APIS</a>
                <!--<a href="#gdpr_standard" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> GDPR STANDARD API</a>-->
                <a onclick="window._sp_.gdpr.loadPrivacyManagerModal('547186', 'purposes')" href="javascript:void(0);" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-th"></i>PRIVACY MANAGER</a>
                <a href="#contact" class="w3-bar-item w3-button" onclick="toggleFunction()">CONTACT</a>
                <a href="#" class="w3-bar-item w3-button">SEARCH</a>
            </div>
        </div>

        <!-- First Parallax Image with Logo Text -->
        <div class="bgimg-1 w3-display-container w3-opacity-min" id="home"></div>

        <div class="w3-content w3-container w3-padding-64" id="intro">
            <p class="w3-wide"><i class="fa fa-laptop"></i>accoundId</p>
            <div class="w3-light-grey">
                <input type="text" id="accountid" name="accountid" value="1732">
            </div>
            <p class="w3-wide"><i class="fa fa-laptop"></i>propertyHref</p>
            <div class="w3-light-grey">
                <input type="text" id="propertyhref" name="propertyhref" value="https://dineshjnarayan.github.io/">
            </div>
            <p class="w3-wide"><i class="fa fa-laptop"></i>pmId</p>
            <div class="w3-light-grey">
                <input type="text" id="pmid" name="pmid" value="547186">
            </div>
            <p class="w3-wide"><i class="fa fa-laptop"></i>baseEndpoint</p>
            <div class="w3-light-grey">
                <input type="text" id="baseendpoint" name="baseendpoint" value="https://cdn.privacy-mgmt.com">
            </div>
            <p class="w3-wide"><i class="fa fa-laptop"></i>Submit</p>
            <div class="w3-light-grey">
                <button onClick="refreshPage();">Submit</button><button onClick="default_val();">Default</button><button onClick="testing_val();">Testing ...</button>
            </div>
        </div>

        <script>

            function refreshPage(){
                var url = '?accountid=' + document.getElementById('accountid').value + '&propertyhref=' + encodeURIComponent(document.getElementById('propertyhref').value) + '&pmid=' + document.getElementById('pmid').value + '&baseendpoint=' + encodeURIComponent(document.getElementById('baseendpoint').value);
                window.location.href = url;
            } 

            function default_val(){
                document.getElementById("accountid").value = 1732;
                document.getElementById("propertyhref").value = 'https://dineshjnarayan.github.io/';
                document.getElementById("pmid").value = 547186;
                document.getElementById("baseendpoint").value = 'https://cdn.privacy-mgmt.com';
            }

            function testing_val(){
                document.getElementById("accountid").value = 1423;
                document.getElementById("propertyhref").value = 'https://www.playpilot.com';
                document.getElementById("pmid").value = 417982;
                document.getElementById("baseendpoint").value = 'https://cmp.playpilot.com';
            }

        </script>

        <!-- Second Parallax Image with Portfolio Text -->
        <div class="bgimg-2 w3-display-container w3-opacity-min">
            <div class="w3-display-middle">
                <span class="w3-xxlarge w3-text-white w3-wide">SOURCEPOINT CALLBACKS</span>
            </div>
        </div>

        <!-- Container (About Section) -->
        <div class="w3-content w3-container w3-padding-64" id="sp_callbacks">
            <!-- OnError Output-->
            <table class="d table-bordered" id="onerror">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onError</strong></caption>
            </table>
            <hr>
            <!-- OnMessageChoiceError Output-->
            <table class="d table-bordered" id="onmessagechoiceerror">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onMessageChoiceError</strong></caption>
            </table>
            <hr>
            <!-- onMessageReady Output-->
            <table class="d table-bordered" id="onmessageready">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onMessageReady</strong></caption>
            </table>
            <hr>
            <!-- onMessageChoiceSelect Output -->
            <table class="d table-bordered" id="onmessagechoiceselect">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onMessageChoiceSelect</strong></caption>
            </table>
            <hr>
            <!-- onSPPMObjectReady Output -->
            <table class="d table-bordered" id="onsppmobject_ready">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onSPPMObjectReady</strong></caption>
            </table>
            <hr>
            <!-- onPrivacyManagerAction Output -->
            <table class="d table-bordered" id="onprivacymanageraction">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onPrivacyManagerAction</strong></caption>
            </table>
            <hr>
            <!-- onConsentReady Output -->
            <table class="d table-bordered" id="onconsentready">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onConsentReady</strong></caption>
            </table>
            <hr>
            <!-- onMessageReceiveData Output -->
            <table class="d table-bordered" id="onmessagereceivedata">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onMessageReceiveData</strong></caption>
            </table>
            <hr>
            <!-- onPMCancel Output -->
            <table class="d table-bordered" id="onpmcancel">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong>onPMCancel</strong></caption>
            </table>
        </div>

        <!-- Second Parallax Image with Portfolio Text -->
        <div class="bgimg-2 w3-display-container w3-opacity-min">
            <div class="w3-display-middle">
                <span class="w3-xxlarge w3-text-white w3-wide">TCF APIs</span>
            </div>
        </div>

        <div class="w3-content w3-container w3-padding-64" id="tcf_apis">
            <!-- Ping Output-->
            <table class="d table-bordered" id="callping">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong><code>__tcfapi('ping', 2, (pingReturn) => { console.log(pingReturn) });</code></strong></caption>
            </table>
            <hr>
            <!-- getTCData Output-->
            <table class="d table-bordered" id="tcfapi_gettcdata">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong><code>__tcfapi('getTCData', 2, function(tcdata, success) { console.log(tcdata); });</code></strong></caption>
            </table>
            <hr>
            <!-- getVendorPurposeMapping Output-->
            <table class="d table-bordered" id="getvendorpurposemapping_table">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong><code>__tcfapi('getVendorPurposeMapping', 2, function(vpm, success) { console.log(vpm) });</code></strong></caption>
            </table>
            <hr>
            <!-- getCustomVendorConsents -->
            <table class="d table-bordered" id="getcustomvendorconsents">
                <caption style="color: #FFFFFF; background-color: #E4E4E4;"><strong><code>__tcfapi('getCustomVendorConsents', 2, function(cvc, success) { console.log(cvc); });</code></strong></caption>
            </table>
        </div>

        <div class="w3-row w3-center w3-dark-grey w3-padding-16">
            <div class="w3-section">
                <span class="w3-xlarge" id="vendors_counter"></span><br>Vendors
            </div>
        </div>

        <!-- Second Parallax Image with Portfolio Text -->
        <!--<div class="bgimg-2 w3-display-container w3-opacity-min">
            <div class="w3-display-middle">
                <span class="w3-xxlarge w3-text-white w3-wide">GDPR STANDARD API</span>
            </div>
        </div>-->
        
        <!-- Third Parallax Image with Portfolio Text -->
        <div class="bgimg-3 w3-display-container w3-opacity-min">
            <div class="w3-display-middle">
                <span class="w3-xxlarge w3-text-white w3-wide">CONTACT</span>
            </div>
        </div>

        <!-- Container (Contact Section) -->
        <div class="w3-content w3-container w3-padding-64" id="contact">
            <h3 class="w3-center">WHERE I WORK</h3>
            <div class="w3-row w3-padding-32 w3-section">
                <div class="w3-col m4 w3-container">
                    <img src="https://www.w3schools.com/w3images/map.jpg" class="w3-image w3-round" style="width:100%">
                </div>
                <div class="w3-col m8 w3-panel">
                    <div class="w3-large w3-margin-bottom">
                        <i class="fa fa-map-marker fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Sourcepoint GmbH, Friedrichstrasse 68, Berlin<br>
                        <i class="fa fa-phone fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Phone: +49 0176 81000369<br>
                        <i class="fa fa-envelope fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Email: dinesh@sourcepoint.com<br>
                    </div>
                    <p>I ♥ <i class="fa fa-coffee"></i></p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="w3-center w3-black w3-padding-64 w3-opacity w3-hover-opacity-off">
            <a href="#home" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>To the top</a>
            <div class="w3-xlarge w3-section">
                <i class="fa fa-facebook-official w3-hover-opacity"></i>
                <i class="fa fa-instagram w3-hover-opacity"></i>
                <i class="fa fa-snapchat w3-hover-opacity"></i>
                <i class="fa fa-pinterest-p w3-hover-opacity"></i>
                <i class="fa fa-twitter w3-hover-opacity"></i>
                <i class="fa fa-linkedin w3-hover-opacity"></i>
            </div>
            <p>Edit <a onclick="window._sp_.gdpr.loadPrivacyManagerModal(url_pmid, 'purposes')" href="javascript:void(0);" class="w3-hover-text-green">Privacy Settings</a></p>
            <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
        </footer>
        
        <script>
            
            // Change style of navbar on scroll
            window.onscroll = function() {myFunction()};
            function myFunction() {
                var navbar = document.getElementById("myNavbar");
                if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                    navbar.className = "w3-bar" + " w3-card" + " w3-animate-top" + " w3-white";
                } else {
                    navbar.className = navbar.className.replace(" w3-card w3-animate-top w3-white", "");
                }
            }

            // Used to toggle the menu on small screens when clicking on the menu button
            function toggleFunction() {
                var x = document.getElementById("navDemo");
                if (x.className.indexOf("w3-show") == -1) {
                    x.className += " w3-show";
                } else {
                    x.className = x.className.replace(" w3-show", "");
                }
            }

        </script>

    </body>
</html>